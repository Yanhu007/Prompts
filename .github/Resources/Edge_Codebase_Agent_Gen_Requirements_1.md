以下是你所要求的需求描述，内容围绕生成一个 **Edge codebase expert Agent 的 prompt 框架**，用于自动构建特定 Agent 的初始 Prompt 文件，涵盖修改流程、安全性、准确性等方面。

---

# **Edge Codebase Expert Agent Prompt 框架 — 需求描述**

## **目标**

设计并实现一个通用的 Prompt 生成框架，用于为 Edge 代码库构建智能 Agent 的初始 prompt。该框架应：

* 提炼并继承 `.github/prompts/` 中已有的 Agent prompt 设计规范和最佳实践。
* 封装对 Edge 代码修改过程的通用步骤与关键注意事项。
* 强调对代码修改操作的 **准确性、安全性和可溯性**。
* 支持根据用户输入的 Agent 名称与描述，生成标准化的 `${agent_name}.prompt.md` 文件，并保存到 `.github/prompts/` 目录下。

---

## **功能需求**

### 1. 用户输入交互

* 系统应主动请求用户输入：

  * `agent_name`：此 Agent 的唯一标识。
  * `agent_description`：该 Agent 所执行任务的领域背景、目标和职责。

### 2. 需求解析与确认

* 系统需根据 `agent_description` 提取任务意图与操作范围。
* 如果存在模糊、多解或潜在风险的描述，应主动反馈对描述的理解，并请求用户确认或补充。

---

## **Prompt 框架内容**

生成的 Agent Prompt 文件应包括以下模块，形成统一模板：

### A. Agent 角色定义

说明该 Agent 是 Edge 代码库专家，熟悉以下内容：

* Edge 架构及其模块组成（Frontend, Browser, WebUI, Platform 等）
* Edge 的构建流程、配置方式和依赖关系
* 安全可靠地执行代码增删改的能力
* 遵循团队的开发流程和 review 要求

### B. 通用修改流程

每个 Agent 的 prompt 中，应包括以下通用流程指导：

1. **理解任务目标**：结合用户输入与代码库上下文，厘清任务范围。
2. **收集相关信息**：

   * 搜索与任务相关的代码文件、头文件、配置文件、测试文件、文档等。
   * 分析它们之间的依赖关系和调用链。
3. **生成变更计划**：

   * 明确需要删除、修改、添加的文件及操作原因。
   * 形成一份结构化的变更计划文档。
4. **执行变更操作**：

   * 严格按照变更计划实施，避免误改。
   * 所有 git 命令使用 `;` 分隔，禁止 `&&`。
   * 禁止在 `main` 分支执行，若当前分支为 `main`，应提示用户切换或创建新分支。
5. **构建验证**：

   * 在每次变更后进行 build，并遵循 `../resources/edgebuild.md` 的流程。
   * 支持 debug 或 release 构建，需用户确认后执行。
   * 检查构建环境是否初始化、输出目录是否存在，必要时执行初始化或 `autogn`。
6. **结果记录与复查**：

   * 生成和更新包括 `执行计划`, `依赖分析`, `代码理解`, `checklist` 等在 `.memory` 中的任务文档。
   * 执行完成后复查 checklist，确保无遗漏，必要时补充执行。

---

## **注意事项与约束**

* 所有文本与代码搜索应使用 Haystack search 和 file search，**禁止使用 VSCode 默认搜索功能**。
* 所有命令操作必须在 **单一终端中执行**，**禁止创建多个终端**。
* 构建命令、构建类型、构建路径均应严格遵从 `../resources/edgebuild.md`。
* Agent 不负责管理分支，只能在当前分支上执行任务；但需提醒用户确认当前分支状态。
* Agent 应能准确理解用户任务意图，对含糊或不完整的需求进行澄清并记录确认。

---

## **输出文件规范**

* 生成的 Prompt 文件保存路径：

  ```
  .github/prompts/${agent_name}.prompt.md
  ```
* 文件内容必须具备高度结构化、模块化，可直接用于 Agent 执行。

---

## **扩展能力（建议性）**

为了支持更复杂或自动化的用例，该框架未来可扩展：

* 根据领域需求自动填充 prompt 中的搜索范围、模块关注点等。
* 自动生成初始的 checklist 模版。
* 根据 task 名称生成 `.memory` 下相关分析、执行文档模版。

---

